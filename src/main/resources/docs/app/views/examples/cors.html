<!--
  ~  The MIT License (MIT)
  ~
  ~  Copyright (c) 2014-2016 Lee Collins
  ~
  ~  Permission is hereby granted, free of charge, to any person obtaining a copy
  ~  of this software and associated documentation files (the "Software"), to deal
  ~  in the Software without restriction, including without limitation the rights
  ~  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~  copies of the Software, and to permit persons to whom the Software is
  ~  furnished to do so, subject to the following conditions:
  ~
  ~  The above copyright notice and this permission notice shall be included in
  ~  all copies or substantial portions of the Software.
  ~
  ~  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  ~  THE SOFTWARE.
  -->

<span class="example-header">gServ CORS Example</span>
<br/>
<span class="example-howto-header">How-to: Implement Cross-Site-Scripting in gServ Application</span>

<p class="example-content">Use the <i>CORS plugin. </i>The plugin adds 1 CORS configuration
    function to the server instance config for configuring the plugin.
<pre>cors (uri, corsConfig )</pre>

The plugin adds 3 functions for the 3 modes:
AllowAll<br/>
BlackList<br/>
WhiteList<br/>

The arguments:<br/>
<table>
    <tr>
        <th width="25%"><span class="docs-heading">Argument</span></th>
        <th><span class="docs-heading">Description</span></th>
    </tr>
    <tr>
        <td>methods</td>
        <td>List containing HTTP methods affected by the Basic Auth requirement</td>
    </tr>
    <tr>
        <td>path</td>
        <td>Path to be protected byBasic Auth</td>
    </tr>
    <tr>
        <td>realmName</td>
        <td>Security realm</td>
    </tr>
    <tr>
        <td>challengeFn</td>
        <td>Closure with signature closure(user, password)</td>
    </tr>
</table>
</p>
</div>
<span class="example-complete-header">Complete Example</span>

<p class="example-sub-header">
    Prerequisites:<br/></p>
<li>Gradle installed</li>
<li>gServ installed into local Maven repo</li>
<p class="example-sub-header">Files:<br/></p>
<li>BasicAuth.groovy</li>
<li>build.gradle</li>


<span class="example-content">Create a new directory: BasicAuthExample.  Copy the following code to BasicAuthExample/src/main/groovy/BasicAuth.groovy.</span>
<pre>import io.github.javaconductor.gserv.GServ

class BasicAuthExample {

    static void main(String[] args){
        def gserv = new GServ();

        gserv.http((Map)[:]) { ->
        /*
            def basicAuthentication(methods, path, realm, challengeFn)
         */
            basicAuthentication(['GET',"POST","PUT"], "/secured", "testRealm"){ user, pswd ->
                def ok =  ( user == "secret" && pswd == "thing" )
                println "u=$user p=$pswd : ${ok?"OK":"FAILED"}";
                ok
            }

            get("/"){ ->
                write("text/plain", "Public Page - No auth required." );
            }

            get("/secured"){ ->
                write("text/plain", "This is the authenticated path!" );
            }

        }.start(12000);
    }
}
</pre>
<span class="example-content"> Copy the following code to <i>BasicAuthExample/build.gradle</i>. </span>
<pre>
/*
 * This build file was auto generated by running the Gradle 'init' task
 * by 'javaConductor' at '12/30/13 3:35 AM' with Gradle 1.9
 *
 */

// Apply the java plugin to add support for Java
apply plugin: 'groovy'
apply plugin: 'application'
apply plugin: 'maven'

mainClassName = 'BasicAuthExample'
group = "gserv.example.basicauth"
version = "1.0.0"

repositories {
    mavenCentral()
    mavenLocal()
}

dependencies {
    // The production code uses the SLF4J logging API at compile time
    compile 'org.slf4j:slf4j-api:1.7.5'
    compile 'log4j:log4j:1.2.17'
    compile('org.codehaus.groovy:groovy-all:2.3.0')
    compile("com.soulsys:gserv:0.0.1")
}</pre>
<span class="example-content">Tell Gradle to build and run the example. In the BasicAuthExample directory, </span>
<pre> gradle build run</pre>

<span class="example-content"><br/>Navigate your browser to: http://localhost:12000/ to see the public page.<br/>
        Now, navigate to http://localhost:12000/secured.  You will have to login with user/password = secret/thing to see the secured page.
    </span>

</div>
